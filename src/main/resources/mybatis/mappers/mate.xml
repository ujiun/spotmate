<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mate">

	<!-- mateList 가져오기 -->	
	<select id="selectMateList" resultType="MateVo">
		<![CDATA[
				select  u.name,
       				    c.carName,
       				    c.carPicture,
       				    c.carName,
       				    c.carNo,
       				    c.introduce,
       				    s.no mateNo,
				        to_char(s.startDate,'mm.dd') startDate,
        				to_char(s.endDate, 'mm.dd') endDate,
				        s.people,
				        s.type,
				        s.point,
				        s.duration,
					    s.distance,
					    s.comments
				from users u,
				     car c,
				     spotmate s
				where u.no = c.userNo
				and   c.no = s.carNo
				and s.type = '메이트'
		]]>
	</select>
	
	<!-- mateList 가져오기(애완동물 가능여부 체크) -->	
	<select id="selectMateOptionList" resultType="MateVo">
		<![CDATA[
				select mateNo mateOptionNo,
				       s.detailNo,
				       d.name optionName
				from spotDetail s , detailOption d, spotmate sp
				where s.detailNo = d.no
				and sp.no = s.mateNo
				and sp.type = '메이트'
				and s.detailno = 3
		]]>
	</select>
	
	<!-- mateList 가져오기(도착, 출발장소만 가져오기) -->	
	<select id="selectMatePlaceList" resultType="MateVo">
		<![CDATA[
				select s.Place sPlace,
				       e.place ePlace,
				       s.mateNo
				from place s, (select Place,
				                      mateNo
			                   from place
			                   where wayNo = 0
			                   and day = 1) e
				where s.wayNo = -1
				and s.day = 1
				and s.mateNo = e.mateNo
		]]>
	</select>
	
	<!-- mateNo에 맞는 데이터값 가져오기 -->
	<select id="deepMateRead" resultType="MateVo" parameterType="int">
		<![CDATA[
				select no mateNo,
				       carNo,
				       startDate,
				       people,
				       endDate,
				       point,
				       comments
				from spotmate
				where no = #{mateNo}
		]]>
	</select>
	
	<!-- mateNo에 맞는 장소값 가져오기 -->
	<select id="deepPlaceRead" resultType="MateVo" parameterType="int">
		<![CDATA[
				select p.mateNo,
				       p.day,
				       p.wayNo wayNo,
				       p.sepplace,
				       to_char(p.time, 'AM HH:MI') time,
				       p.place,
				       p.lat,
				       p.lng,
				       p.latlng,
				       to_char(s.startDate, 'yyyy.mm.dd day') startDate,
				       to_char(s.endDate, 'yyyy.mm.dd day') endDate
				from place p, spotmate s
				where s.no = p.mateNo
				and p.mateNo = #{mateNo}
		]]>
	</select>
	
</mapper>


