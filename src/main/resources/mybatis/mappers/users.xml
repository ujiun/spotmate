<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="users">

	<insert id="joinUser" parameterType="userVo">
		<selectKey keyProperty="no" resultType="int" order="BEFORE">
				select seq_users_no.nextval from dual 
		</selectKey>
		insert all
		into users
		values(	#{no}, 
		        #{id}, 
		        #{pw},
		        #{name},
		        #{email},
		        #{phone},
		        #{address}||","||#{addressDeatil},
		        #{gender},
		        #{birth},
		        '',
		        ''
		)
		into car
		values (
			seq_car_no.nextval,
			#{no},
			'',
			'',
			'',
			'',
			'',
			''
		)
		select * from dual
	</insert>
	
	<select id="loginOk" parameterType="userVo" resultType="userVo">
		select u.no no
			   ,u.name name
			   ,c.no carNo
		from users u, car c
		where u.no = c.userNo
		and id = #{id}
		and pw = #{pw}
	</select>

</mapper>